<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Param√®tres | P√©pins de tüçÖmates</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #fdfdfc;
            --text-main: #2d3436;
            --text-light: #636e72;
            --accent: #d63031;
            --card-bg: #ffffff;
            --shadow: 0 10px 30px rgba(0,0,0,0.05);
            --transition: all 0.3s ease;
        }

        body.dark-mode {
            --bg-color: #121212;
            --text-main: #e0e0e0;
            --text-light: #a0a0a0;
            --card-bg: #1e1e1e;
            --shadow: 0 10px 30px rgba(0,0,0,0.4);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
            transition: background-color 0.3s;
        }

        header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            gap: 1rem;
        }

        .btn-back {
            background: none; border: none; 
            color: var(--text-main); 
            font-size: 1.5rem; 
            cursor: pointer;
            width: 40px; height: 40px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            transition: var(--transition);
        }
        .btn-back:hover { background: rgba(0,0,0,0.05); transform: translateX(-5px); }

        h1 { font-size: 2rem; font-weight: 800; }

        .section-title {
            color: var(--accent);
            font-weight: 700;
            margin: 2rem 0 1rem;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 1px;
            border-bottom: 2px solid rgba(0,0,0,0.05);
            padding-bottom: 5px;
        }

        .setting-card {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .setting-row:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }

        .setting-info strong { display: block; font-size: 1rem; margin-bottom: 4px; }
        .setting-info small { color: var(--text-light); font-size: 0.85rem; }

        /* Switches */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute; content: "";
            height: 20px; width: 20px;
            left: 4px; bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(22px); }

        /* Selects & Inputs */
        select.setting-control {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.1);
            background: var(--bg-color);
            color: var(--text-main);
            font-family: inherit;
        }

        .font-controls {
            display: flex;
            gap: 5px;
        }
        .font-btn {
            width: 35px; height: 35px;
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.1);
            background: var(--bg-color);
            color: var(--text-main);
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold;
        }
        .font-btn.active { background: var(--text-main); color: var(--bg-color); }

        .btn-danger {
            background: #ff7675; color: white; border: none;
            padding: 10px 20px; border-radius: 8px;
            font-weight: 700; cursor: pointer; width: 100%;
            margin-top: 10px;
        }
        .btn-danger:hover { background: #d63031; }

    </style>
</head>
<body>

    <header>
        <button class="btn-back" onclick="window.location.href='index.html'">‚Üê</button>
        <h1 data-i18n="title">Param√®tres</h1>
    </header>

    <div class="section-title" data-i18n="sec_interface">üñ•Ô∏è Interface</div>
    <div class="setting-card">
        <div class="setting-row">
            <div class="setting-info">
                <strong data-i18n="dark_mode">Mode Sombre</strong>
                <small data-i18n="dark_mode_desc">R√©duit la fatigue oculaire</small>
            </div>
            <label class="switch">
                <input type="checkbox" id="theme-toggle" onchange="settings.toggleTheme()">
                <span class="slider"></span>
            </label>
        </div>
        <div class="setting-row">
            <div class="setting-info">
                <strong data-i18n="anim">Animations</strong>
                <small data-i18n="anim_desc">Activer pour plus de fluidit√©</small>
            </div>
            <label class="switch">
                <input type="checkbox" id="anim-toggle" onchange="settings.toggleAnim()">
                <span class="slider"></span>
            </label>
        </div>
        <div class="setting-row">
            <div class="setting-info">
                <strong data-i18n="compact">Mode Compact</strong>
                <small data-i18n="compact_desc">Plus de cartes, moins de d√©tails</small>
            </div>
            <label class="switch">
                <input type="checkbox" id="compact-toggle" onchange="settings.toggleCompact()">
                <span class="slider"></span>
            </label>
        </div>
        <div class="setting-row">
            <div class="setting-info">
                <strong data-i18n="columns">Colonnes Grille</strong>
                <small data-i18n="columns_desc">Forcer le nombre de colonnes</small>
            </div>
            <select id="grid-cols" class="setting-control" onchange="settings.setGrid(this.value)">
                <option value="auto">Auto</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
            </select>
        </div>
    </div>

    <div class="section-title" data-i18n="sec_font">üî§ Police</div>
    <div class="setting-card">
        <div class="setting-row">
            <div class="setting-info">
                <strong data-i18n="font_size">Taille du texte</strong>
                <small data-i18n="font_size_desc">Ajuster la lisibilit√©</small>
            </div>
            <div class="font-controls">
                <button class="font-btn" onclick="settings.setFont('14px')" id="font-s">A</button>
                <button class="font-btn" onclick="settings.setFont('16px')" id="font-m" style="font-size:1.1rem">A</button>
                <button class="font-btn" onclick="settings.setFont('19px')" id="font-l" style="font-size:1.3rem">A</button>
            </div>
        </div>
    </div>

    <div class="section-title" data-i18n="sec_lang">üåç Langue</div>
    <div class="setting-card">
        <div class="setting-row">
            <div class="setting-info">
                <strong data-i18n="lang_app">Langue de l'application</strong>
            </div>
            <select id="lang-select" class="setting-control" onchange="settings.setLang(this.value)">
                <option value="fr">Fran√ßais üá´üá∑</option>
                <option value="en">English üá¨üáß</option>
            </select>
        </div>
    </div>

    <div class="section-title" data-i18n="sec_privacy">üîê Donn√©es & Confidentialit√©</div>
    <div class="setting-card">
        <div class="setting-row">
            <div class="setting-info">
                <strong data-i18n="analytics">Cookies Analytics</strong>
                <small data-i18n="analytics_desc">Autoriser Google Analytics (Anonyme)</small>
            </div>
            <label class="switch">
                <input type="checkbox" id="analytics-toggle" onchange="settings.toggleAnalytics()">
                <span class="slider"></span>
            </label>
        </div>
        <div class="setting-row" style="flex-direction: column; align-items: flex-start; gap: 10px;">
            <div class="setting-info">
                <strong style="color:#d63031" data-i18n="danger_zone">Zone de danger</strong>
                <small data-i18n="delete_desc">Supprime les favoris, le panier et les pr√©f√©rences.</small>
            </div>
            <button class="btn-danger" onclick="settings.wipeData()" data-i18n="btn_delete">üóëÔ∏è Supprimer toutes mes donn√©es</button>
        </div>
    </div>

    <footer style="text-align:center; color:var(--text-light); font-size:0.8rem; margin-top:2rem;">
        P√©pins de Tomates - v2.0 - Developed by Tom Duval
    </footer>

    <script>
        const translations = {
            fr: {
                title: "Param√®tres",
                sec_interface: "üñ•Ô∏è Interface",
                dark_mode: "Mode Sombre", dark_mode_desc: "R√©duit la fatigue oculaire",
                anim: "Animations", anim_desc: "Activer pour plus de fluidit√©",
                compact: "Mode Compact", compact_desc: "Plus de cartes, moins de d√©tails",
                columns: "Colonnes Grille", columns_desc: "Forcer le nombre de colonnes",
                sec_font: "üî§ Police",
                font_size: "Taille du texte", font_size_desc: "Ajuster la lisibilit√©",
                sec_lang: "üåç Langue", lang_app: "Langue de l'application",
                sec_privacy: "üîê Donn√©es & Confidentialit√©",
                analytics: "Cookies Analytics", analytics_desc: "Autoriser Google Analytics (Anonyme)",
                danger_zone: "Zone de danger", delete_desc: "Supprime les favoris, le panier et les pr√©f√©rences.",
                btn_delete: "üóëÔ∏è Supprimer toutes mes donn√©es"
            },
            en: {
                title: "Settings",
                sec_interface: "üñ•Ô∏è Interface",
                dark_mode: "Dark Mode", dark_mode_desc: "Reduces eye strain",
                anim: "Animations", anim_desc: "Enable for smoother experience",
                compact: "Compact Mode", compact_desc: "More cards, less details",
                columns: "Grid Columns", columns_desc: "Force column count",
                sec_font: "üî§ Font",
                font_size: "Text Size", font_size_desc: "Adjust readability",
                sec_lang: "üåç Language", lang_app: "Application Language",
                sec_privacy: "üîê Data & Privacy",
                analytics: "Analytics Cookies", analytics_desc: "Allow Google Analytics (Anonymous)",
                danger_zone: "Danger Zone", delete_desc: "Deletes favorites, cart and preferences.",
                btn_delete: "üóëÔ∏è Delete all my data"
            }
        };

        const settings = {
            init() {
                // Charger √©tat
                document.getElementById('theme-toggle').checked = localStorage.getItem('darkMode') === 'true';
                if(localStorage.getItem('darkMode') === 'true') document.body.classList.add('dark-mode');
                
                document.getElementById('anim-toggle').checked = localStorage.getItem('noAnim') !== 'true'; // Inverse logic in localstorage
                
                document.getElementById('compact-toggle').checked = localStorage.getItem('compact') === 'true';
                document.getElementById('grid-cols').value = localStorage.getItem('gridCols') || 'auto';
                
                const currentLang = localStorage.getItem('lang') || 'fr';
                document.getElementById('lang-select').value = currentLang;
                this.applyLang(currentLang);

                const currentSize = localStorage.getItem('fontSize') || '16px';
                this.highlightFontBtn(currentSize);
                document.documentElement.style.fontSize = currentSize;

                // Cookies
                const analytics = localStorage.getItem('cookie_analytics');
                document.getElementById('analytics-toggle').checked = analytics === 'true';
            },

            toggleTheme() {
                const isDark = document.getElementById('theme-toggle').checked;
                localStorage.setItem('darkMode', isDark);
                document.body.classList.toggle('dark-mode', isDark);
            },

            toggleAnim() {
                const animsOn = document.getElementById('anim-toggle').checked;
                localStorage.setItem('noAnim', !animsOn);
            },

            toggleCompact() {
                localStorage.setItem('compact', document.getElementById('compact-toggle').checked);
            },

            setGrid(val) {
                localStorage.setItem('gridCols', val);
            },

            setFont(size) {
                document.documentElement.style.fontSize = size;
                localStorage.setItem('fontSize', size);
                this.highlightFontBtn(size);
            },

            highlightFontBtn(size) {
                document.querySelectorAll('.font-btn').forEach(b => b.classList.remove('active'));
                if(size === '14px') document.getElementById('font-s').classList.add('active');
                if(size === '16px') document.getElementById('font-m').classList.add('active');
                if(size === '19px') document.getElementById('font-l').classList.add('active');
            },

            setLang(lang) {
                localStorage.setItem('lang', lang);
                this.applyLang(lang);
            },

            applyLang(lang) {
                const texts = translations[lang];
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if(texts[key]) el.innerText = texts[key];
                });
            },

            toggleAnalytics() {
                const allowed = document.getElementById('analytics-toggle').checked;
                localStorage.setItem('cookie_analytics', allowed);
                if(allowed) localStorage.setItem('cookie_consent_status', 'accepted'); // Partiel
            },

            wipeData() {
                if(confirm("√ätes-vous s√ªr ? Cela effacera toutes vos listes et pr√©f√©rences.")) {
                    localStorage.clear();
                    // Clear IndexedDB
                    const req = indexedDB.deleteDatabase("TomatoDB");
                    req.onsuccess = () => {
                        alert("Donn√©es supprim√©es. L'application va red√©marrer.");
                        window.location.href = 'index.html';
                    };
                }
            }
        };

        settings.init();
    </script>
</body>
</html>
